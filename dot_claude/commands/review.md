---
description:
globs:
alwaysApply: false
---

PR レビュー時に使用してください。

## 手順

- NEVER: テスト`npm run test`や型チェック`npm run check-type`、開発サーバの起動`npm run dev`等は実行しないこと

1. `git branch --show-current`で現在いるブランチを取得し、そのブランチに対応する PR をれびゅーしてください
2. `PAGER="" gh pr view` で PR のタイトル・説明・状態を取得
   - YOU MUST: 対応する PR が存在しない場合は、後続処理を行わず「対応する PR がありません」と出力
   - YOU MUST: PR の説明欄に対応する issue のリンクが記載されていない場合も、後続処理を行わず「対応する Issue のリンクがありません」と出力
3. `PAGER="" gh pr diff` で PR の差分（diff）を取得
   - YOU MUST: terraform や CI、ドキュメントではなく，フロントエンド・バックエンドの変更の場合にテストコードが無く、特記事項にその理由が記載されていない場合は、後続処理を行わず「テストコードを追加するか、無い理由を説明欄に記載してください」と出力
4. PR の説明欄にある issue のリンクを用いて、`PAGER="" gh issue view`で issue の内容を確認
5.
6. `docs/`配下の設計ドキュメントを確認
7. PR に含まれている言語に応じて次のコマンドでファイルを取得すること
   - TypeScript: !`gh api -H "Accept: application/vnd.github.raw" /repos/sen-corporation/coding-guideline/contents/frontend/guideline.md`
   - Go: !`gh api -H "Accept: application/vnd.github.raw" /repos/sen-corporation/coding-guideline/contents/backend/golang.md`
8. 収集した情報を基に次の観点でよく考えること
   - Issue に対する PR の変更内容が妥当か
   - 他代替案がないか
   - 各ドキュメントに反した実装がないか。ある場合はどのファイルのどの記述に反しているか
   - 各言語のベストプラクティスに沿っているかどうか
   - テストコードがあるか
   - テストコードに過不足がないか
   - 不要なファイルがコミットされてないか
   - PR の変更内容に関して更新した方が良いドキュメントが無いか
   - コードの品質チェック
     - 命名が妥当か
     - 関数・クラス・パッケージ分割が適切か
     - パスワードなどのハードコーディングが無いか
     - マジックナンバーが無いか
     - 同じレイヤーのコードと似た実装になっているか
     - 適切にログが出力されているか
     - 例外処理の考慮漏れがないか
     - 非同期処理の扱いは適切か
     - 外部から渡されるデータにはバリデーションがあるか
     - 型定義が適切か
     - より簡潔に実装することができないか
     - DRY、SOLID などの原則に過度に違反したコードがないか
     - 過度にパフォーマンスを下げる実装になってないか
     - コメントがあった方が良いコードがないか(複雑な処理、一般的ではない実装)
     - 不要なコメントがないか
9. 取得した情報をもとに、次の内容を日本語で要約。markdown 形式で記述し、pbcopy でクリップボードへのコピーもお願いします
   - Issue の概要(100 文字)
   - PR の目的(100 文字)
   - 主な変更点（箇条書き）
   - テストコードの有無
   - AI が確認したこと(Step6 で考えたことを箇条書き)
   - レビュワーに確認してほしいこと
     - SPEC の内容を満たせているか
     - 動作確認の実施
       - [ ] コンソールやログにエラーやワーニングが出てないか
       - [ ] ハッピーパスが動作するか
       - [ ] エッジケースでエラーにならないか
         - エッジケース一覧
     - 他 AI が確認していない・AI がレビューしたが人間にもレビューしてほしい観点
   - For レビュイー
     - レビュー貰う前に確認したほうが良いこと
       - CI が成功していること
     - 次 PR を作成する際に改善できること
   - 最後に「この出力はそのまま PR のコメントにコピペしてください。AI の出力に正しくない点や不備があれば別途コメントしてください。プロンプトの改善に用います。また、AI の指摘事項は必ず修正しないといけない訳ではありません。」と出力すること

