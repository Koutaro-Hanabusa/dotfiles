---
name: nb-knowledge
description: Q&Aのやりとり、コードレビューの学び、デザインパターンの発見、セッションの気づきをnbノートブックにバックグラウンドで自動記録します。常時稼働 — ユーザーの呼び出し不要。
---

このスキルはセッション全体を通じてnbノートブックへのナレッジ自動記録を管理します。

## 記録ルール

- すべてのnb記録はバックグラウンドで実行すること（Bashで `run_in_background: true`）。メインの会話フローをブロックしないこと。
- nb書き込みにユーザー確認は不要 — 常に自動で記録する。

## 記録対象

- Q&Aのやりとり（質問とその回答）
- コードレビューの学び（例：バリデーションルール、フレームワークの挙動）
- デザインパターンの発見（例：アーキテクチャの意思決定、状態管理のアプローチ）
- バグ修正とその根本原因
- セッション中に得られたあらゆる知見

## 記録方法

1. 仕事用PCか個人PCかを判定：
   - 仕事用PC: `~/.is_work_pc` が存在する → `work:knowledge/` を使用
   - 個人PC: `home:knowledge/` を使用

2. 新規ノートの作成：

```bash
# 仕事用PC
nb add work:knowledge/ -c "内容"

# 個人PC
nb add home:knowledge/ -c "内容"
```

3. 既存ノートの更新は、Editツールでファイルを直接編集し、`nb sync` で反映する：
   - Home: `~/.nb/home/knowledge/<ファイル名>`
   - Work: `~/.nb/work/knowledge/<ファイル名>`
   - **`nb edit` は絶対に使わない** — nvimが起動して非対話環境ではハングする。

4. `nb sync` 実行時は、アクティブノートブックにリモートが設定されていることを確認する。
   `work` ノートブックにはリモート未設定の場合がある。先に正しいノートブックに切り替えること：

```bash
nb use home && nb sync
# または
nb use work && nb sync
```

## ノートのフォーマット

```markdown
# <トピックタイトル>

## 日付: YYYY-MM-DD

## <セクション1>
- 要点
- 必要に応じてコード例

## <セクション2>
...
```

## 重要事項

- 常にバックグラウンドで実行すること — ユーザーをnb操作で待たせない。
- 関連する学びは多数の小ファイルを作るのではなく、1つのノートにまとめる。
- 後から検索しやすいよう、説明的なトピックタイトルをつける。
