{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "hooks": {
    "UserPromptSubmit": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "input=$(cat); timestamp=$(date -u +%Y-%m-%dT%H:%M:%SZ); session_id=$(echo \"$input\" | jq -r '.session_id // empty'); cwd=$(echo \"$input\" | jq -r '.cwd // empty'); prompt=$(echo \"$input\" | jq -r '.prompt // empty'); prompt_length=${#prompt}; project=$(basename \"$cwd\"); summary=$(echo \"$prompt\" | head -c 100); log_dir=\"$HOME/.config/claude-otel-monitoring/logs\"; mkdir -p \"$log_dir\"; jq -cn --arg ts \"$timestamp\" --arg et \"user_prompt\" --arg sid \"$session_id\" --arg cwd \"$cwd\" --arg proj \"$project\" --argjson plen \"${prompt_length:-0}\" --arg sum \"$summary\" '{timestamp: $ts, event_type: $et, session_id: $sid, cwd: $cwd, project: $proj, prompt_length: $plen, summary: $sum}' >> \"$log_dir/claude-hooks.log\""
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Task|Skill|mcp__.*",
        "hooks": [
          {
            "type": "command",
            "command": "input=$(cat); timestamp=$(date -u +%Y-%m-%dT%H:%M:%SZ); tool_name=$(printf '%s' \"$input\" | jq -r '.tool_name // empty'); session_id=$(printf '%s' \"$input\" | jq -r '.session_id // empty'); if [ \"$tool_name\" = \"Skill\" ]; then event_type=\"skill_call\"; elif [ \"$tool_name\" = \"Task\" ]; then event_type=\"subagent_spawn\"; elif printf '%s' \"$tool_name\" | grep -q '^mcp__'; then event_type=\"mcp_call\"; else event_type=\"tool_call\"; fi; mcp_server=\"\"; if [ \"$event_type\" = \"mcp_call\" ]; then mcp_server=$(printf '%s' \"$tool_name\" | sed 's/^mcp__//; s/__.*//'); fi; subagent_type=$(printf '%s' \"$input\" | jq -r '.tool_input.subagent_type // empty'); skill=$(printf '%s' \"$input\" | jq -r '.tool_input.skill // empty'); description=$(printf '%s' \"$input\" | jq -r '.tool_input.description // empty'); prompt=$(printf '%s' \"$input\" | jq -r '.tool_input.prompt // empty' | head -c 200); args=$(printf '%s' \"$input\" | jq -r '.tool_input.args // empty'); log_dir=\"$HOME/.config/claude-otel-monitoring/logs\"; mkdir -p \"$log_dir\"; jq -cn --arg ts \"$timestamp\" --arg et \"$event_type\" --arg tn \"$tool_name\" --arg sid \"$session_id\" --arg sat \"$subagent_type\" --arg sk \"$skill\" --arg desc \"$description\" --arg pr \"$prompt\" --arg ar \"$args\" --arg ms \"$mcp_server\" '{timestamp: $ts, event_type: $et, tool_name: $tn, session_id: (if $sid != \"\" then $sid else null end), subagent_type: (if $sat != \"\" then $sat else null end), skill: (if $sk != \"\" then $sk else null end), mcp_server: (if $ms != \"\" then $ms else null end), description: (if $desc != \"\" then $desc else null end), prompt: (if $pr != \"\" then $pr else null end), args: (if $ar != \"\" then $ar else null end)}' >> \"$log_dir/claude-hooks.log\""
          }
        ]
      }
    ],
    "Stop": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "afplay /Users/hanabusa.kotaro/Downloads/dorakue-reberuatsupuyin.mp3"
          }
        ]
      },
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "marker=/tmp/.claude-nb-reminded; now=$(date +%s); if [ -f \"$marker\" ]; then last=$(stat -f %m \"$marker\"); if [ $(( now - last )) -lt 60 ]; then exit 0; fi; fi; touch \"$marker\"; if [ -f \"$HOME/.is_work_pc\" ]; then notebook=\"work\"; else notebook=\"home\"; fi; echo \"[nb-knowledge] Record session learnings if any (Q&A, bug fixes, design decisions). Use: nb add ${notebook}:knowledge/ -c 'content'. Skip if nothing to record or already recorded.\""
          }
        ]
      }
    ]
  },
  "enabledPlugins": {
    "typescript-lsp@claude-plugins-official": true,
    "pr-review-toolkit@claude-plugins-official": true,
    "figma@claude-plugins-official": true
  },
  "alwaysThinkingEnabled": true,
  "bash_patterns_to_allow": [
    "find *",
    "mkdir *",
    "curl *",
    "grep *",
    "sed *",
    "nb add *",
    "nb edit *",
    "nb list *",
    "nb ls *",
    "nb show *",
    "nb search *",
    "nb count *",
    "nb help *",
    "nb history *",
    "nb notebooks *",
    "nb export *",
    "nb bookmark *",
    "nb browse *",
    "nb copy *",
    "nb folders *",
    "nb git *",
    "nb import *",
    "nb do *",
    "nb env *",
    "mcp__time__get_current_time"
  ],
  "teammateMode": "tmux",
  "env": {
    "CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS": "1"
  },
  "feedbackSurveyState": {
    "lastShownTime": 1754061737891
  },
  "statusLine": {
    "type": "command",
    "command": "input=$(cat); cwd=$(echo \"$input\" | jq -r '.cwd'); user=$(whoami); host=$(hostname -s); display_dir=\"${cwd/#$HOME/~}\"; git_info=\"\"; if git -C \"$cwd\" rev-parse --git-dir > /dev/null 2>&1; then branch=$(git -C \"$cwd\" --no-optional-locks branch --show-current 2>/dev/null || echo \"\"); if [ -n \"$branch\" ]; then dirty=\"\"; staged=\"\"; untracked=\"\"; if ! git -C \"$cwd\" --no-optional-locks diff --quiet 2>/dev/null; then dirty=\"*\"; fi; if ! git -C \"$cwd\" --no-optional-locks diff --cached --quiet 2>/dev/null; then staged=\"+\"; fi; if [ -n \"$(git -C \"$cwd\" --no-optional-locks ls-files --others --exclude-standard 2>/dev/null)\" ]; then untracked=\"%\"; fi; git_info=\" $(printf '\\033[38;5;208m')($branch$dirty$staged$untracked)$(printf '\\033[0m')\"; fi; fi; printf \"%s@%s $(printf '\\033[34m')%s$(printf '\\033[0m')%s \" \"$user\" \"$host\" \"$display_dir\" \"$git_info\""
  }
}
